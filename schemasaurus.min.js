(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.schemasaurus=e()}})(function(){var e,t,r;return function n(e,t,r){function i(o,s){if(!t[o]){if(!e[o]){var u=typeof require=="function"&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var r=e[o][1][t];return i(r?r:t)},l,l.exports,n,e,t,r)}return t[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,r){"use strict";var n=e("./iterator_base");var i=e("./standardExtensions");var a=e("./v4validator");var o=e("./selector");function s(e,t){var r,a;r=new n(e,t);i(r);a=r.iterate.bind(r);a.schema=function(e){r.schema(e);return a};return a}function u(e){return f(a(e),e)}function f(e,t){return s(o(e),t)}t.exports={Iterator:s,Selector:f,Validator:u};u.meta=a.meta;s.meta=n.meta},{"./iterator_base":2,"./selector":3,"./standardExtensions":4,"./v4validator":5}],2:[function(e,t,r){"use strict";function n(e){return JSON.parse(JSON.stringify(e))}function i(e,t){function r(){var e;for(e in t){if(t.hasOwnProperty(e)){this[e]=t[e]}}}r.prototype=e;return new r}function a(e,t){if(typeof e!=="function"){throw new Error("callback shall be a function")}switch(e.length){case 0:break;case 3:var r=e;e=function(){return r};break;default:throw new Error("Callback constructor shall have no arguments")}this._callbackCtor=e;if(t&&t.schema){this._schema=t.schema}this.attrs=i(a.prototype.attrs,t&&t.attrs?t.attrs:{});this.types=i(a.prototype.types,t&&t.types?t.types:{});this._options=t||{}}a.prototype.schema=function(e){if(!e){throw new Error("Schema shall be an object")}this._schema=n(e);return this};a.prototype.attrs={};a.prototype.types={};function o(e){return e===undefined||e===null}a.prototype.iterate=function(e,t){if(this._schema){t=e;e=this._schema}var r=this;function n(e,i,a,s){var u,f,l;u={path:function(){return s},attribute:undefined,value:function(){return a[0][1]},parent:function(e){var t=a[e||1]||[];return{schema:t[0],object:t[1]}},visit:function(e,t){if(e===undefined){return}if(!Array.isArray(e)){return n(e,t,a,s)}return e.map(function(e){return n(e,t,a,s)})},refbase:[]};f=r._callbackCtor();if(f===undefined){throw new Error("Callback shall be specified")}l={schemaOnly:t===undefined,options:r._options,visit:function(e,t,n){var i,p,c,m,d;if(e.$$visited&&o(t)){return}Object.defineProperty(e,"$$visited",{value:true,configurable:true});if(e.id){u.refbase.push(e.id)}if(n){s.push(n)}a.unshift([e,t]);f(e,t,u);i=[];c=e.type;for(m in r.attrs){if(r.attrs.hasOwnProperty(m)&&e.hasOwnProperty(m)){p=r.attrs[m];if(typeof p==="string"){c=p;p=null}else{i.push(p)}}}p=r.types[c];if(p){i.push(p)}for(d=0;d<i.length;d=d+1){i[d](e,t,l,c)}a.shift();if(n){s.pop()}if(e.id){u.refbase.pop()}delete e.$$visited},parent:function(e){e=e||1;return a[e]},report:function(e){u.attribute=e;f(a[0][0],a[0][1],u);u.attribute=undefined},resolveRef:function(t){function r(e){return e.replace(/~0/g,"~").replace(/~1/g,"/")}var n=decodeURI(t).split("#"),i=n[0],a=n[1].split("/").map(r),o=e,s;if(i!==""){throw new Error("Remote refs are not supported for now :(")}for(s=0;s<a.length;s=s+1){if(a[s]===""){continue}o=o[a[s]];if(o===undefined){throw new Error("Cannot find ref '"+t+"' in schema")}}return o}};if(Object.defineProperty){Object.keys(l).forEach(function(e){Object.defineProperty(l,e,{editable:false,value:l[e]})})}l.visit(e,i);u.finished=true;u.attribute="finished";return f(null,null,u)}return n(e,t,[],[])};Object.defineProperty(a.prototype,"meta",{get:function(){var e=this;return{type:function(t,r){e.types[t]=r},attr:function(t,r){e.attrs[t]=r}}}});a.meta={type:function(e,t){a.prototype.types[e]=t},attr:function(e,t){a.prototype.attrs[e]=t}};t.exports=a},{}],3:[function(e,t,r){"use strict";var n=/(\[(\^?\w+)(=\w+)?\])/g;var i=/:(\w+)$/;function a(e){function t(e,r){if(e[0]==="^"){return"!("+t(e.substring(1),r)+")"}return r!==null?"schema."+e+" === "+JSON.stringify(r):"typeof schema."+e+" !== 'undefined'"}function r(e){return e?"ctx.attribute === "+JSON.stringify(e):"typeof ctx.attribute === 'undefined'"}function a(e){if(e===null){return null}var t=parseFloat(e);if(!isNaN(t)){return t}if(e==="true"){return true}if(e==="false"){return false}return e}var o=[],s=n.exec(e);while(s){o.push(t(s[2],a(s[3]?s[3].substring(1):null)));s=n.exec(e)}s=i.exec(e);if(o.length===0&&!s){throw new Error("Cannot parse selector `"+e+"`")}o.push(r(s?s[1]:null));return"("+o.join(" && ")+")"}function o(e){var t="if (#1) { stop = true; selectors[#2](schema, object, ctx, next); if (stop) return; };",r="return function() { var selectors = selectorsCtor(); return function(schema, object, ctx) { if (schema == null) {return selectors.done ? selectors.done() : null}; var stop; function next() { stop = false; };",n="}};",i=[r],o,s,u=null;if(typeof e!=="function"){u=e;e=function(){return u}}else{u=e()}for(o in u){if(u.hasOwnProperty(o)&&o!=="done"){s=a(o);i.push(t.replace("#1",s).replace("#2","'"+o+"'"))}}i.push(n);return new Function("selectorsCtor",i.join("\n"))(e)}t.exports=o},{}],4:[function(e,t,r){"use strict";t.exports=function(e){e.meta.type("object",function(e,t,r){var n,i={},a,o,s,u;if(e.default&&(Array.isArray(e.default)||typeof e.default!=="object")){delete e.default}for(n in e.properties){if(e.properties.hasOwnProperty(n)){r.visit(e.properties[n],t?t[n]:undefined,n);i[n]=true}}if(t&&!Array.isArray(t)&&typeof t==="object"){if(!e.$$patterns&&typeof e.patternProperties==="object"){e.$$patterns=[];for(n in e.patternProperties){if(e.patternProperties.hasOwnProperty(n)){e.$$patterns.push({re:new RegExp(n),sc:e.patternProperties[n]})}}}u=e.additionalProperties;if(e.additionalProperties===false){u={additionalAllowed:false}}else if(typeof e.additionalProperties!=="object"){u={additionalAllowed:true}}for(n in t){if(t.hasOwnProperty(n)){s=e.$$patterns?e.$$patterns.length:0;for(a=0;a<s;a=a+1){o=e.$$patterns[a];if(o.re.test(n)){r.visit(o.sc,t[n],n);i[n]=true}}if(!i[n]){r.visit(u,t[n],n)}}}}r.report("end")});e.meta.attr("properties","object");e.meta.attr("additionalProperties","object");e.meta.attr("patternProperties","object");e.meta.type("array",function(e,t,r){var n=e.items||{},i;if(e.default&&!Array.isArray(e.default)){delete e.default}if(Array.isArray(n)){for(i=0;i<e.items.length;i=i+1){r.report("start-item");r.visit(e.items[i],t?t[i]:undefined,"["+i+"]");r.report("end-item")}if(typeof e.additionalItems==="object"){for(i=e.items.length;i<(t?t.length:0);i=i+1){r.report("start-item");r.visit(e.additionalItems,t?t[i]:undefined,"["+i+"]");r.report("end-item")}}}else if(r.schemaOnly){r.report("start-item");r.visit(e.items||{},null,"[]");r.report("end-item")}else{for(i=0;i<(t?t.length:0);i=i+1){r.report("start-item");r.visit(e.items||{},t[i],"["+i+"]");r.report("end-item")}}r.report("end")});e.meta.attr("items","array");e.meta.attr("additionalItems","array");e.meta.attr("default",function(e,t,r,n){var i,a=e.default;switch(n){case"boolean":i=typeof a==="boolean";break;case"string":i=typeof a==="string";break;case"number":i=typeof a==="number";break;case"null":i=a===null;break;case"integer":i=typeof a==="number"&&a%1===0;break}if(!i){delete e.default}});e.meta.attr("$ref",function(e,t,r){var n=e,i;while(n.$ref){n=r.resolveRef(n.$ref)}for(i in n){if(n.hasOwnProperty(i)){e[i]=n[i]}}delete e.$ref;r.visit(e,t)})}},{}],5:[function(e,t,r){"use strict";function n(e){return{"type.string":e("shall be a string"),"type.null":e("shall be null"),"type.string.minLength":e("shall have length at least %d"),"type.string.maxLength":e("shall have length no more than %d"),"type.string.pattern":e("shall match pattern %s"),"type.string.format.email":e("is not a valid e-mail"),"type.integer":e("shall be an integer"),"type.integer.multipleOf":e("shall be multiple of %d"),"type.number":e("shall be a number"),"type.number.minimum":e("shall be >= %d"),"type.number.minimum.exclusive":e("shall be > %d"),"type.number.maximum":e("shall be <= %d"),"type.number.maximum.exclusive":e("shall be < %d"),"type.boolean":e("shall be boolean"),"type.object":e("shall be object"),"type.object.required":e("is required"),"type.object.additionalProperties":e("shall not have additional properties"),"type.object.minProperties":e("shall have at least %d properties"),"type.object.maxProperties":e("shall have no more than %d properties"),"type.array":e("shall be array"),"type.array.additionalItems":e("shall not have additional items"),"type.array.minItems":e("shall have at least %d items"),"type.array.maxItems":e("shall have no more %d items"),"type.array.uniqueItems":e("shall have unique items"),"type.enum":e("shall be one of values %s"),required:e("is required"),dependency:e("does not meet additional requirements for %s"),not:e("does not meet 'not' requirement"),oneOf:e("does not meet exactly one requirement"),"oneOf.zero":e("does not meet any requirement"),allOf:e("does not meet all requirements"),anyOf:e("does not meet any requirement")}}var i={};function a(e){return typeof e==="object"&&!Array.isArray(e)&&e!==null}function o(e,t){var r=[];function n(t,n,i,a){r.push({code:t,message:e[t]||i||function(){throw new Error("There is no message registered for error '"+t+"'")}(),value:n.value(),arg:i,path:n.path().join(".").replace(/\.\[/g,"[")+(a?"."+a:"")})}function i(e){if(e){n.apply(null,[].slice.call(arguments,1))}}function o(e){r.splice.apply(r,[r.length,0].concat(e))}function s(e){return typeof e==="object"?JSON.stringify(e):e}return{"[^required]":function(e,t,r,n){var i=r.parent().schema;if(i&&t===undefined){return}n()},"[type]":function(e,t,r,i){var o=Array.isArray(e.type)?e.type:[e.type],s;for(s=0;s<o.length;s=s+1){switch(o[s]){case"null":if(t===null){return i()}break;case"string":if(typeof t==="string"){return i()}break;case"integer":if(typeof t==="number"&&t%1===0){return i()}break;case"number":if(typeof t==="number"){return i()}break;case"boolean":if(typeof t==="boolean"){return i()}break;case"array":if(Array.isArray(t)){return i()}break;case"object":if(a(t)){return i()}break}}o.forEach(function(e){n("type."+e,r)})},"[dependencies]":function(e,t,r,i){var a,s,u;for(a in e.dependencies){if(e.dependencies.hasOwnProperty(a)){s=e.dependencies[a];if(Array.isArray(s)){s={required:s}}if(t.hasOwnProperty(a)){u=r.visit(s,t);if(!u.valid){n("dependency",r,a);o(u.errors)}}}}i()},"[allOf]":function(e,t,r,i){r.visit(e.allOf,t).forEach(function(e){if(!e.valid){n("allOf",r);o(e.errors)}});i()},"[anyOf]":function(e,t,r,i){var a=[],s=r.visit(e.anyOf,t).some(function(e){a=a.concat(e.errors);return e.valid});if(!s){n("anyOf",r);o(a)}i()},"[oneOf]":function(e,t,r,i){var a=0,s=[];r.visit(e.oneOf,t).forEach(function(e){s=s.concat(e.errors);if(e.valid){a=a+1}});if(a===0){n("oneOf.zero",r);o(s)}else if(a!==1){n("oneOf",r)}i()},"[not]":function(e,t,r,i){var a=r.visit(e.not,t);if(a.valid){n("not",r)}i()},"[enum]":function(e,t,r,n){var a=s(t),o;e.$$enum=e.$$enum||e.enum.map(s);o=e.$$enum;i(o.indexOf(a)===-1,"type.enum",r,e.enum);n()},"[maxLength]":function(e,t,r,n){if(typeof t!=="string"){return n()}i(t.length>e.maxLength,"type.string.maxLength",r,e.maxLength);n()},"[minLength]":function(e,t,r,n){if(typeof t!=="string"){return n()}i(t.length<e.minLength,"type.string.minLength",r,e.minLength);n()},"[pattern]":function(e,t,r,n){if(typeof t!=="string"){return n()}i(!t.match(e.pattern),"type.string.pattern",r,e.pattern);n()},"[type=string][format]":function(e,r,n){var a=t[e.format];if(!a){throw new Error("Unknown format '"+e.format+"'. Did you forget to register it?")}i(!(a.regexp instanceof RegExp?a.regexp.test(r):a.test(r,e)),"type.string.format."+a.name,n,a.message)},"[type=string][^format]":function(){},"[additionalItems=false]":function(e,t,r,n){if(!Array.isArray(t)){return n()}i(e.items&&t.length>e.items.length,"type.array.additionalItems",r);n()},"[minItems]":function(e,t,r,n){if(!Array.isArray(t)){return n()}i(t.length<e.minItems,"type.array.minItems",r);n()},"[maxItems]":function(e,t,r,n){if(!Array.isArray(t)){return n()}i(t.length>e.maxItems,"type.array.maxItems",r);n()},"[uniqueItems]":function(e,t,r,n){if(!Array.isArray(t)){return n()}var a={},o,u;for(o=0;o<t.length;o=o+1){u=s(t[o]);i(a[u],"type.array.uniqueItems",r,t[o]);a[u]=true}n()},"[required][^properties]":function(e,t,r,n){if(!a(t)){return n()}var o;for(o=0;o<e.required.length;o=o+1){i(!t.hasOwnProperty(e.required[o]),"type.object.required",r,null,e.required[o])}n()},"[properties]":function(e,t,r,n){if(!a(t)){return n()}e.$keys=Object.keys(e.properties);var o=(e.required||[]).concat(e.$keys.filter(function(t){return e.properties[t].required===true})),s;for(s=0;s<o.length;s=s+1){i(!t.hasOwnProperty(o[s]),"type.object.required",r,null,o[s])}n()},"[maxProperties]":function(e,t,r,n){if(!a(t)){return n()}i(Object.keys(t).length>e.maxProperties,"type.object.maxProperties",r,e.maxProperties);n()},"[minProperties]":function(e,t,r,n){if(!a(t)){return n()}i(Object.keys(t).length<e.minProperties,"type.object.minProperties",r,e.minProperties);n()},"[additionalAllowed=true]":function(){},"[additionalAllowed=false]":function(e,t,r,i){n("type.object.additionalProperties",r);i()},"[multipleOf]":function(e,t,r,n){if(typeof t!=="number"){return n()}var a=t/e.multipleOf;i(a%1!==0,"type.integer.multipleOf",r,e.multipleOf);n()},"[minimum]":function(e,t,r,n){i(e.exclusiveMinimum?t<=e.minimum:t<e.minimum,"type.number.minimum"+(e.exclusiveMinimum?".exclusive":""),r,e.minimum);n()},"[maximum]":function(e,t,r,n){i(e.exclusiveMaximum?t>=e.maximum:t>e.maximum,"type.number.maximum"+(e.exclusiveMaximum?".exclusive":""),r,e.maximum);n()},done:function(){return{valid:r.length===0,errors:r}}}}t.exports=function(e){if(e===undefined){e={}}var t=e.messages||n(e.gettext||function(e){return e}),r={},a;if(e.formats){for(a=0;a<e.formats.length;a=a+1){r[e.formats[a].name]=e.formats[a]}}for(a in i){if(i.hasOwnProperty(a)){r[a]=i[a]}}return o.bind(null,t,r)};t.exports.meta={addFormat:function(e){i[e.name]=e}};t.exports.meta.addFormat({name:"email",regexp:/^[^@]+@[^@]+$/})},{}]},{},[1])(1)});