(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.schemasaurus=e()}})(function(){var e,t,r;return function n(e,t,r){function i(o,s){if(!t[o]){if(!e[o]){var u=typeof require=="function"&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var r=e[o][1][t];return i(r?r:t)},l,l.exports,n,e,t,r)}return t[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,r){var n=e("./iterator_base");var i=e("./standardExtensions");var a=e("./v4validator");var o=e("./selector");function s(e,t){var r=new n(e,t);i(r);var a=r.iterate.bind(r);a.schema=function(e){r.schema(e);return a};return a}function u(e){return f(a(e),e)}function f(e,t){return s(o(e),t)}t.exports={Iterator:s,Selector:f,Validator:u};u.meta=a.meta;s.meta=n.meta},{"./iterator_base":2,"./selector":3,"./standardExtensions":4,"./v4validator":5}],2:[function(e,t,r){"use strict";function n(e){return JSON.parse(JSON.stringify(e))}function i(e,t){if(typeof e!=="function")throw new Error("callback shall be a function");switch(e.length){case 0:break;case 3:var r=e;e=function(){return r};break;default:throw new Error("Callback constructor shall have no arguments")}this._callbackCtor=e;if(t&&t.schema)this._schema=t.schema;this.attrs=t&&t.attrs?t.attrs:{};this.attrs.__proto__=i.prototype.attrs;this.types=t&&t.types?t.types:{};this.types.__proto__=i.prototype.types;this._options=t||{}}i.prototype.schema=function(e){if(!e)throw new Error("Schema shall be an object");this._schema=n(e);return this};i.prototype.attrs={};i.prototype.types={};function a(e){return typeof e==="undefined"||e==null}i.prototype.iterate=function(e,t){if(this._schema){t=e;e=this._schema}var r=this;function n(e,i,o,s){var u={path:function(){return s},attribute:undefined,value:function(){return o[0][1]},parent:function(e){var t=o[e||1]||[];return{schema:t[0],object:t[1]}},visit:function(e,t){if(typeof e==="undefined")return;if(!Array.isArray(e))return n(e,t,o,s);else return e.map(function(e){return n(e,t,o,s)})},refbase:[]};var f=r._callbackCtor();if(typeof f==="undefined")throw new Error("Callback shall be specified");var l={schemaOnly:typeof t==="undefined",options:r._options,visit:function(e,t,n){if(e.$$visited&&a(t)){return}Object.defineProperty(e,"$$visited",{value:true,configurable:true});if(e.id)u.refbase.push(e.id);if(n)s.push(n);o.unshift([e,t]);f(e,t,u);var i=[];var p,c=e.type;for(var m in r.attrs){if(r.attrs.hasOwnProperty(m)&&e.hasOwnProperty(m)){p=r.attrs[m];if(typeof p==="string"){c=p;p=null}else{i.push(p)}}}if(p=r.types[c]){i.push(p)}for(var d=0;d<i.length;d++){i[d](e,t,l,c)}o.shift();if(n)s.pop();if(e.id)u.refbase.pop();delete e.$$visited},parent:function(e){e=e||1;return o[e]},report:function(e){u.attribute=e;f(o[0][0],o[0][1],u);u.attribute=undefined},resolveRef:function(t){function r(e){return e.replace(/~0/g,"~").replace(/~1/g,"/")}var n=decodeURI(t).split("#");var i=n[0],a=n[1].split("/").map(r);if(i!=="")throw new Error("Remote refs are not supported for now :(");var o=e;for(var s=0;s<a.length;s++){if(a[s]==="")continue;o=o[a[s]];if(typeof o==="undefined")throw new Error("Cannot find ref '"+t+"' in schema")}return o}};if(Object.defineProperty){Object.keys(l).forEach(function(e){Object.defineProperty(l,e,{editable:false,value:l[e]})})}l.visit(e,i);u.finished=true;u.attribute="finished";return f(null,null,u)}return n(e,t,[],[])};Object.defineProperty(i.prototype,"meta",{get:function(){var e=this;return{type:function(t,r){e.types[t]=r},attr:function(t,r){e.attrs[t]=r}}}});i.meta={type:function(e,t){i.prototype.types[e]=t},attr:function(e,t){i.prototype.attrs[e]=t}};t.exports=i},{}],3:[function(e,t,r){var n=/(\[(\^?\w+)(=\w+)?\])/g;var i=/:(\w+)$/;function a(e){function t(e,r){if(e[0]=="^"){return"!("+t(e.substring(1),r)+")"}return r!==null?"schema."+e+" === "+JSON.stringify(r):"typeof schema."+e+" !== 'undefined'"}function r(e){return e?"ctx.attribute === "+JSON.stringify(e):"typeof ctx.attribute === 'undefined'"}function a(e){if(e==null)return null;var t=parseFloat(e);if(!isNaN(t))return t;if(e==="true")return true;if(e==="false")return false;return e}var o=[];var s;while(s=n.exec(e)){o.push(t(s[2],a(s[3]?s[3].substring(1):null)))}s=i.exec(e);if(o.length==0&&!s)throw new Error("Cannot parse selector `"+e+"`");o.push(r(s?s[1]:null));return"("+o.join(" && ")+")"}function o(e){var t=null;if(typeof e!=="function"){t=e;e=function(){return t}}else{t=e()}var r="if (#1) { stop = true; selectors[#2](schema, object, ctx, next); if (stop) return; };";var n="return function() { var selectors = selectorsCtor(); return function(schema, object, ctx) { if (schema == null) {return selectors.done ? selectors.done() : null}; var stop; function next() { stop = false; };";var i="}};";var o=[n];for(var s in t){if(t.hasOwnProperty(s)&&s!=="done"){var u=a(s);o.push(r.replace("#1",u).replace("#2","'"+s+"'"))}}o.push(i);var f=Function("selectorsCtor",o.join("\n"));return f(e)}t.exports=o},{}],4:[function(e,t,r){t.exports=function(e){e.meta.type("object",function(e,t,r){var n;if(e.default&&(Array.isArray(e.default)||typeof e.default!=="object")){delete e.default}for(n in e.properties){if(e.properties.hasOwnProperty(n)){r.visit(e.properties[n],t?t[n]:undefined,n)}}if(t&&typeof e.additionalProperties==="object"){for(n in t){if(t.hasOwnProperty(n)){if(e.properties&&e.properties.hasOwnProperty(n))continue;r.visit(e.additionalProperties,t?t[n]:undefined,n)}}}r.report("end")});e.meta.attr("properties","object");e.meta.attr("additionalProperties","object");e.meta.type("array",function(e,t,r){var n=e.items||{};var i;if(e.default&&!Array.isArray(e.default)){delete e.default}if(Array.isArray(n)){for(i=0;i<e.items.length;i++){r.report("start-item");r.visit(e.items[i],t?t[i]:undefined,"["+i+"]");r.report("end-item")}if(typeof e.additionalItems==="object"){for(i=e.items.length;i<(t?t.length:0);i++){r.report("start-item");r.visit(e.additionalItems,t?t[i]:undefined,"["+i+"]");r.report("end-item")}}}else if(r.schemaOnly){r.report("start-item");r.visit(e.items||{},null,"[]");r.report("end-item")}else{for(i=0;i<(t?t.length:0);i++){r.report("start-item");r.visit(e.items||{},t[i],"["+i+"]");r.report("end-item")}}r.report("end")});e.meta.attr("items","array");e.meta.attr("additionalItems","array");e.meta.attr("default",function(e,t,r,n){var i,a=e.default;switch(n){case"boolean":case"string":case"number":i=typeof a===n;break;case"null":i=a===null;break;case"integer":i=typeof a==="number"&&a%1==0;break}if(!i){delete e.default}});e.meta.attr("$ref",function(e,t,r){var n=e;while(n.$ref){n=r.resolveRef(n.$ref)}for(var i in n){if(n.hasOwnProperty(i)){e[i]=n[i]}}delete e.$ref;r.visit(e,t)})}},{}],5:[function(e,t,r){function n(e){return{"type.string":e("shall be a string"),"type.null":e("shall be null"),"type.string.minLength":e("shall have length at least %d"),"type.string.maxLength":e("shall have length no more than %d"),"type.string.pattern":e("shall match pattern %s"),"type.string.format.email":e("is not a valid e-mail"),"type.integer":e("shall be an integer"),"type.integer.multipleOf":e("shall be multiple of %d"),"type.number":e("shall be a number"),"type.number.minimum":e("shall be >= %d"),"type.number.minimum.exclusive":e("shall be > %d"),"type.number.maximum":e("shall be <= %d"),"type.number.maximum.exclusive":e("shall be < %d"),"type.boolean":e("shall be boolean"),"type.object":e("shall be object"),"type.object.required":e("is required"),"type.object.additionalProperties":e("shall not have additional properties"),"type.object.minProperties":e("shall have at least %d properties"),"type.object.maxProperties":e("shall have no more than %d properties"),"type.array":e("shall be array"),"type.array.additionalItems":e("shall not have additional items"),"type.array.minItems":e("shall have at least %d items"),"type.array.maxItems":e("shall have no more %d items"),"type.array.uniqueItems":e("shall have unique items"),"type.enum":e("shall be one of values %s"),required:e("is required"),dependency:e("does not meet additional requirements for %s"),not:e("does not meet 'not' requirement"),oneOf:e("does not meet exactly one requirement"),"oneOf.zero":e("does not meet any requirement"),allOf:e("does not meet all requirements"),anyOf:e("does not meet any requirement")}}var i={};function a(e){return typeof e==="object"&&!Array.isArray(e)&&e!==null}t.exports=function(e){if(typeof e==="undefined")e={};var t=e.messages||n(e.gettext||function(e){return e});var r={};if(e.formats){for(var o=0;o<e.formats.length;o++){r[e.formats[o].name]=e.formats[o]}}r.__proto__=i;return function(){var e=[];function n(r,n,i,a){e.push({code:r,message:t[r]||i||function(){throw new Error("There is no message registered for error '"+r+"'")}(),value:n.value(),arg:i,path:n.path().join(".").replace(/\.\[/g,"[")+(a?"."+a:"")})}function i(e){if(e)n.apply(null,[].slice.call(arguments,1))}function o(t){e.splice.apply(e,[e.length,0].concat(t))}function s(e){return typeof e==="object"?JSON.stringify(e):e}return{"[^required]":function(e,t,r,n){var i=r.parent().schema;if(i&&(typeof t==="undefined"||t===null)){return}n()},"[type]":function(e,t,r,i){var o=Array.isArray(e.type)?e.type:[e.type];for(var s=0;s<o.length;s++){switch(o[s]){case"null":if(t===null)return i();break;case"string":if(typeof t==="string")return i();break;case"integer":if(typeof t==="number"&&t%1===0)return i();break;case"number":if(typeof t==="number")return i();break;case"boolean":if(typeof t==="boolean")return i();break;case"array":if(Array.isArray(t))return i();break;case"object":if(a(t))return i()}}o.forEach(function(e){n("type."+e,r)})},"[dependencies]":function(e,t,r,i){for(var a in e.dependencies){if(e.dependencies.hasOwnProperty(a)){var s=e.dependencies[a];if(Array.isArray(s)){s={required:s}}if(t.hasOwnProperty(a)){var u=r.visit(s,t);if(!u.valid){n("dependency",r,a);o(u.errors)}}}}i()},"[allOf]":function(e,t,r,i){r.visit(e.allOf,t).forEach(function(e){if(!e.valid){n("allOf",r);o(e.errors)}});i()},"[anyOf]":function(e,t,r,i){var a=[];var s=r.visit(e.anyOf,t).some(function(e){a=a.concat(e.errors);return e.valid});if(!s){n("anyOf",r);o(a)}i()},"[oneOf]":function(e,t,r,i){var a=0;var s=[];r.visit(e.oneOf,t).forEach(function(e){s=s.concat(e.errors);if(e.valid)a++});if(a===0){n("oneOf.zero",r);o(s)}else if(a!=1){n("oneOf",r)}i()},"[not]":function(e,t,r,i){var a=r.visit(e.not,t);if(a.valid){n("not",r)}i()},"[enum]":function(e,t,r,n){var a=s(t),o=e.$$enum=e.$$enum||e.enum.map(s);i(o.indexOf(a)==-1,"type.enum",r,e.enum);n()},"[maxLength]":function(e,t,r,n){if(typeof t!=="string")return n();i(t.length>e.maxLength,"type.string.maxLength",r,e.maxLength);n()},"[minLength]":function(e,t,r,n){if(typeof t!=="string")return n();i(t.length<e.minLength,"type.string.minLength",r,e.minLength);n()},"[pattern]":function(e,t,r,n){if(typeof t!=="string")return n();i(!t.match(e.pattern),"type.string.pattern",r,e.pattern);n()},"[type=string][format]":function(e,t,n){var a=r[e.format];if(!a)throw new Error("Unknown format '"+e.format+"'. Did you forget to register it?");i(!(a.regexp instanceof RegExp?a.regexp.test(t):a.test(t,e)),"type.string.format."+a.name,n,a.message)},"[type=string][^format]":function(){},"[additionalItems=false]":function(e,t,r,n){if(!Array.isArray(t))return n();i(e.items&&t.length>e.items.length,"type.array.additionalItems",r);n()},"[minItems]":function(e,t,r,n){if(!Array.isArray(t))return n();i(t.length<e.minItems,"type.array.minItems",r);n()},"[maxItems]":function(e,t,r,n){if(!Array.isArray(t))return n();i(t.length>e.maxItems,"type.array.maxItems",r);n()},"[uniqueItems]":function(e,t,r,n){if(!Array.isArray(t))return n();var a={};for(var o=0;o<t.length;o++){var u=s(t[o]);i(a[u],"type.array.uniqueItems",r,t[o]);a[u]=true}n()},"[required][^properties]":function(e,t,r,n){if(!a(t))return n();for(var o=0;o<e.required.length;o++){i(!t.hasOwnProperty(e.required[o]),"type.object.required",r,null,e.required[o])}n()},"[properties]":function(e,t,r,n){if(!a(t))return n();e.$keys=Object.keys(e.properties);var o=(e.required||[]).concat(e.$keys.filter(function(t){return e.properties[t].required===true}));for(var s=0;s<o.length;s++){i(!t.hasOwnProperty(o[s]),"type.object.required",r,null,o[s])}n()},"[maxProperties]":function(e,t,r,n){if(!a(t))return n();i(Object.keys(t).length>e.maxProperties,"type.object.maxProperties",r,e.maxProperties);n()},"[minProperties]":function(e,t,r,n){if(!a(t))return n();i(Object.keys(t).length<e.minProperties,"type.object.minProperties",r,e.minProperties);n()},"[additionalProperties=false]":function(e,t,r,n){if(!a(t))return n();var o=e.$keys||[];for(var s in t){if(t.hasOwnProperty(s)){i(o.indexOf(s)==-1,"type.object.additionalProperties",r,s)}}n()},"[multipleOf]":function(e,t,r,n){if(typeof t!=="number")return n();var a=t/e.multipleOf;i((a|0)!==a,"type.integer.multipleOf",r,e.multipleOf);n()},"[minimum]":function(e,t,r,n){i(e.exclusiveMinimum?t<=e.minimum:t<e.minimum,"type.number.minimum"+(e.exclusiveMinimum?".exclusive":""),r,e.minimum);n()},"[maximum]":function(e,t,r,n){i(e.exclusiveMaximum?t>=e.maximum:t>e.maximum,"type.number.maximum"+(e.exclusiveMaximum?".exclusive":""),r,e.maximum);n()},done:function(){return{valid:e.length==0,errors:e}}}}};t.exports.meta={addFormat:function(e){i[e.name]=e}};t.exports.meta.addFormat({name:"email",regexp:/^[^@]+@[^@]+$/})},{}]},{},[1])(1)});